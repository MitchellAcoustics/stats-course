{
  "hash": "b906c691c7469ab4356650efac7eb47b",
  "result": {
    "markdown": "---\ntitle: \"Bootstrapping\"\nformat:\n  revealjs:\n    author: \"STAT 20: Introduction to Probability and Statistics\"\n    height: 900\n    width: 1600\n    theme: ../../assets/slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: c\n    incremental: false\n    center: false\n    menu: false\n    highlight-style: github\n    progress: false\n    code-overflow: wrap\n    title-slide-attributes:\n      data-background-image: ../../assets/stat20-hex-bg.png\n      data-background-size: contain\n---\n\n\n## While you're waiting\n\nIf you've been given an index card, please write on it:\n\n1. Your first name\n2. Your year at Cal (1 is first year, 2 is second year, etc)\n3. Whether or not you are interested in majoring in a business- or econ-related field. 1 = yes, 0 = no\n\n:::notes\nAs students arrive, randomly give ~8 of them an index card.\n:::\n\n\n## Agenda\n\n- Concept Question\n- Activity: The Bootstrap\n- Bootstrapping with `infer`\n\n# Concept Question\n\n## {.smaller}\n\n:::poll\nWhich of these is a valid bootstrap sample?\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_d7204998\" data-update-every=\"1\" tabindex=\"0\" style=\"top:0;right:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n:::: columns\n::: {.column width=\"33%\"}\n\n<br>\n<br>\n<br>\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Original Sample</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> species </th>\n   <th style=\"text-align:right;\"> length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luz </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 48.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 52.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ola </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 44.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Abe </td>\n   <td style=\"text-align:left;\"> Adelie </td>\n   <td style=\"text-align:right;\"> 42.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n::: {.column width=\"33%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>BS A</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> species </th>\n   <th style=\"text-align:right;\"> length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 52.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luz </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 48.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Abe </td>\n   <td style=\"text-align:left;\"> Adelie </td>\n   <td style=\"text-align:right;\"> 42.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ola </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 44.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 52.8 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>BS B</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> species </th>\n   <th style=\"text-align:right;\"> length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Ola </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 44.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 52.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Luz </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 48.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n::: {.column width=\"33%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>BS C</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> species </th>\n   <th style=\"text-align:right;\"> length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ola </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 48.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ola </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 52.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Gentoo </td>\n   <td style=\"text-align:right;\"> 44.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ida </td>\n   <td style=\"text-align:left;\"> Adelie </td>\n   <td style=\"text-align:right;\"> 42.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>BS D</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> species </th>\n   <th style=\"text-align:right;\"> length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Abe </td>\n   <td style=\"text-align:left;\"> Adelie </td>\n   <td style=\"text-align:right;\"> 42.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gus </td>\n   <td style=\"text-align:left;\"> Chinstrap </td>\n   <td style=\"text-align:right;\"> 50.7 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n::::\n\n# The Bootstrap\n\n## {background-image=\"images/triptych-bootstrap.jpg\" background-size=\"contain\"}\n\n\n\n## Parameters and Statistics\n\n\\\n\n**Our Goal**: Assess the sampling error / variability in our estimate of the _median_ year at Cal and the proportion of students in an econ-related field.\n\n. . .\n\n\\\n\n\n**Our Tool**: The Bootstrap\n\n\n## {background-image=\"images/boot-1.jpg\" background-size=\"contain\"}\n\n## Collecting a sample of data\n\nIf you've been given an index card, please write on it:\n\n1. Your first name\n2. Your year at Cal (1 is first year, 2 is second year, etc)\n3. Whether or not you are interested in majoring in a business- or econ-related field. 1 = yes, 0 = no\n\n##\n\nboardwork\n\n:::notes\nCollect index cards from students and record the data into a data frame on the board labelled \"Observed sample\". Calculate the sample median and sample proportion of econ-related majors.\n\nAsk for a volunteer to generate the first bootstrap sample. Hand them the stack of cards and have them randomly choose a single card and read off the data to you. As they do so, write out the first row of a \"Bootstrap Sample 1\" data frame on the board. Be sure to label the row with the student name - that helps emphasis when there are repeats.Have them return the card to the deck, shuffle, and randomly choose a card and read off the data. Repeat until you have filled out the same number of rows as in the original data set. Calculate the median and proportion (you may want to write dplyr code to do this using `summarize()`).\n\nAsk for a second volunteer to generate the second bootstrap sample. Repeat the procedure as before, drawing a third data frame on the board and computing a second set of statistics (median and proportion).\n\nCollect the bootstrapped medians and proportions and sketch them as the first few points in a broader density plot that we'll be able to see when we take more and more bootstrap samples. Label this as the \"bootstrap distribution\" and speak of it as an approximation to the true sampling distribution. You can explain the 1 - alpha bootstrap interval as the interval that captures the middle 95% of bootstrapped statistics.\n:::\n\n# Bootstrapping with Infer\n\n## {background-image=\"images/infer-plain.jpg\" background-size=\"contain\"}\n\n## {background-image=\"images/infer-code.jpg\" background-size=\"contain\"}\n\n## Example: Penguins\n\nLet's consider our 344 penguins to be a SRS from the broader population of Antarctic penguins. What is a point and interval estimate for the population proportion of penguins that are Adelie?\n\n\\\n\n\n::: {.cell}\n\n:::\n\n\n. . .\n\n:::{.columns}\n:::{.column width=\"67%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins <- penguins %>%\n  mutate(is_adelie = species == \"Adelie\")\n\npenguins %>%\n  ggplot(aes(x = is_adelie)) +\n  geom_bar()\n```\n:::\n\n\n\\\n\\\n\\\n\n:::\n\n:::{.column width=\"33%\" .fragment}\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\n\n## Point estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobs_stat <- penguins %>%\n  summarize(p_adelie = mean(is_adelie))\nobs_stat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_adelie\n     <dbl>\n1    0.442\n```\n:::\n:::\n\n\n\n## Generating one bootstrap sample\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(infer)\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 1, \n           type = \"bootstrap\")\n```\n:::\n\n\n. . .\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nResponse: is_adelie (factor)\n# A tibble: 344 × 2\n# Groups:   replicate [1]\n   replicate is_adelie\n       <int> <fct>    \n 1         1 FALSE    \n 2         1 FALSE    \n 3         1 TRUE     \n 4         1 FALSE    \n 5         1 TRUE     \n 6         1 TRUE     \n 7         1 FALSE    \n 8         1 TRUE     \n 9         1 TRUE     \n10         1 TRUE     \n# … with 334 more rows\n```\n:::\n:::\n\n\n\n## Two more bootstrap samples\n\n:::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 1, \n           type = \"bootstrap\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResponse: is_adelie (factor)\n# A tibble: 344 × 2\n# Groups:   replicate [1]\n   replicate is_adelie\n       <int> <fct>    \n 1         1 FALSE    \n 2         1 TRUE     \n 3         1 FALSE    \n 4         1 FALSE    \n 5         1 FALSE    \n 6         1 TRUE     \n 7         1 TRUE     \n 8         1 FALSE    \n 9         1 FALSE    \n10         1 FALSE    \n# … with 334 more rows\n```\n:::\n:::\n\n:::\n\n:::{.column width=\"50%\" .fragment}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 1, \n           type = \"bootstrap\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResponse: is_adelie (factor)\n# A tibble: 344 × 2\n# Groups:   replicate [1]\n   replicate is_adelie\n       <int> <fct>    \n 1         1 FALSE    \n 2         1 TRUE     \n 3         1 TRUE     \n 4         1 FALSE    \n 5         1 FALSE    \n 6         1 TRUE     \n 7         1 TRUE     \n 8         1 FALSE    \n 9         1 FALSE    \n10         1 FALSE    \n# … with 334 more rows\n```\n:::\n:::\n\n:::\n:::\n\n\n## Visualizing 9 bs samples {auto-animate=true}\n\n:::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 9, \n           type = \"bootstrap\") %>%\n  ggplot(aes(x = is_adelie)) +\n  geom_bar() +\n  facet_wrap(vars(replicate),\n             nrow = 3)\n```\n:::\n\n:::\n\n:::{.column width=\"50%\" .fragment}\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\n## Calculating 9 $\\hat{p}$ {auto-animate=true}\n\n:::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 9, \n           type = \"bootstrap\") %>%\n  calculate(stat = \"prop\")\n```\n:::\n\n:::\n\n:::{.column width=\"50%\" .fragment}\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nResponse: is_adelie (factor)\n# A tibble: 9 × 2\n  replicate  stat\n      <int> <dbl>\n1         1 0.404\n2         2 0.430\n3         3 0.404\n4         4 0.433\n5         5 0.468\n6         6 0.448\n7         7 0.427\n8         8 0.413\n9         9 0.474\n```\n:::\n:::\n\n:::\n:::\n\n. . .\n\n> Note the change in data frame size.\n\n\n## The bootstrap dist (reps = 500) {auto-animate=true}\n\n. . .\n\n:::{.columns}\n:::{.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 500, \n           type = \"bootstrap\") %>%\n  calculate(stat = \"prop\") %>%\n  ggplot(aes(x = stat)) +\n  geom_histogram()\n```\n:::\n\n:::\n\n:::{.column width=\"50%\" .fragment}\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\n\n## Interval Estimate\n\n. . .\n\nWe can extract the middle 95% by identifying the .025 quantile and the .975 quantile of the bootstrap distribution with `get_ci()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  specify(response = is_adelie,\n          success = \"TRUE\") %>%\n  generate(reps = 500, \n           type = \"bootstrap\") %>%\n  calculate(stat = \"prop\") %>%\n  get_ci(level = .95)\n```\n:::\n\n\n. . .\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1    0.392    0.494\n```\n:::\n:::\n\n\n\n## `infer` Documentation\n\n![](images/infer-docs.png)\n\n## Your Turn\n\n:::poll\nCreate a 95% confidence interval for the median bill length of penguins.\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_1c76c4f8\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n\n## {background-image=\"images/infer-code.jpg\" background-size=\"contain\"}\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}