{
  "hash": "5f61666d8293474d4d8b69b3984916e1",
  "result": {
    "markdown": "---\ntitle: \"Practice: Pricing Houses\"\n---\n\n\nPlease run the following code cell to load in the data and do the preliminary data wrangling steps found in the notes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.2      ✔ forcats 0.5.1 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nLA <- read_csv(\"https://www.dropbox.com/s/nzhmtmmnz4ix4rd/LA.csv?dl=1\") %>%\n    mutate(log_price = log(price),\n           log_sqft = log(sqft),\n           garage_num = na_if(garage, \"4+\"),\n           garage_num = as.numeric(garage_num),\n           garage_cat = fct_collapse(garage,\n                                     \"none\" = \"0\",\n                                     \"small\" = \"1\",\n                                     \"large\" = c(\"2\", \"3\", \"4+\")))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1594 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): city, type, garage, pool\ndbl (4): bed, bath, sqft, price\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n### Question 1\n\n#### Data Wrangling Review\n\nWhich cities contain the three outlier mega-mansions discovered in the notes?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOLUTION\nLA %>%\n    filter(sqft > 20000) %>%\n    select(city)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 1\n  city         \n  <chr>        \n1 Beverly Hills\n2 Beverly Hills\n3 Beverly Hills\n```\n:::\n\n```{.r .cell-code}\n# or \n\n LA %>%\n     arrange(desc(sqft)) %>%\n     select(city)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,594 × 1\n   city         \n   <chr>        \n 1 Beverly Hills\n 2 Beverly Hills\n 3 Beverly Hills\n 4 Beverly Hills\n 5 Beverly Hills\n 6 Beverly Hills\n 7 Beverly Hills\n 8 Beverly Hills\n 9 Beverly Hills\n10 Beverly Hills\n# … with 1,584 more rows\n```\n:::\n:::\n\n\n\n### Question 2\n\n#### Transformations\n\nFit two linear models: one that predicts price with sqft and another that predicts log price with log sqft. Which one explains the variance in price better, as measured by r squared?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOLUTION\nm1 <- lm(price ~ sqft, data = LA)\nm2 <- lm(log_price ~ log_sqft, data = LA)\n\nlibrary(broom)\nglance(m1) %>%\n    select(r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  r.squared\n      <dbl>\n1     0.729\n```\n:::\n\n```{.r .cell-code}\nglance(m2) %>%\n    select(r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  r.squared\n      <dbl>\n1     0.774\n```\n:::\n:::\n\n\n### Question 3\n\n#### Making predictions\n\nFit a linear model that predicts `log_price` using `log_sqft`, `bed`, and `bath`.\n\nLast year the University of California purchased a new house to serve as the residence of the university President and to host university functions. The address of the house is 2821 Claremont Blvd in Berkeley. Use your linear model to predict the sale price of this house. (hint: the internet is helpful!)\n\nWas your model an under- or over-estimate? Why do you think this is?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOLUTION\nm3 <- lm(log_price ~ log_sqft + bed + bath, data = LA)\n\nnewdata <- data.frame(log_sqft = log(6640),\n                      bed = 6,\n                      bath = 6)\n\ny_hat <- predict(m3, newdata)\nexp(y_hat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1 \n4371452 \n```\n:::\n\n```{.r .cell-code}\n# https://www.berkeleyside.org/2022/04/12/uc-buys-6-5-million-berkeley-mansion-president\n# https://www.redfin.com/CA/Berkeley/2821-Claremont-Blvd-94705/home/1871142\n# the prediction is a big underestimate. the main reason is the the LA \n# data was collected in 2013, when home prices were far lower. there may\n# also be a geography effect where homes in the bay area cost more than homes\n# homes in los angeles.\n```\n:::\n\n\n\n### Question 4\n\n#### Making more predictions\n\nUsing the model from the previous question, predict the sale price of a house that is 1000 sqft and has 100 bedrooms and 2 bathrooms. Do you expect your prediction to be an over- or under estimate? Why?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOLUTION\nnewdata <- data.frame(log_sqft = log(1000),\n                      bed = 100,\n                      bath = 2)\n\ny_hat <- predict(m3, newdata)\nexp(y_hat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         1 \n0.01861811 \n```\n:::\n\n```{.r .cell-code}\n# it's hard to believe any piece of property would only cost 18.6 cents.\n# two explanations: 1) 100 bedrooms could be a typo or 2) its a very strange building to be divided up so narrowly. even if it makes a poor house, it is likely still worth more than 18 cents.\n```\n:::\n\n\n\n\n### Question 5\n\n#### Using predictions\n\nWho might find useful a model like this that predicts the dollar value of a house? Try to brainstorm at least three different uses.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SOLUTIONS\n\n# some ideas:\n# - buyers trying to calibrate their offer\n# - owners determining how much they'd make if they sold their house\n# - sellers deciding how much to list their house for\n# - insurance companies determining how much coverage is recommended\n# - governments determining how much the house is worth to determine how \n#   property tax the owner should pay\n# - appraisers doing their job (determining the value of a home to secure\n#   a loan)\n```\n:::\n",
    "supporting": [
      "handout_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}